{% extends "base_generic.html" %}
{% load static %}
{% block extrascripts %}
<script src="https://js.stripe.com/v3/"></script>
<script>
var stripe = Stripe('{{ stripe_pk }}');

function myFunction(){
  document.getElementById("error-message").innerHTML = "myFunction is called";
  stripe.redirectToCheckout({
  // Make the id field from the Checkout Session creation API response
  // available to this file, so you can provide it as parameter here
  // instead of the {{CHECKOUT_SESSION_ID}} placeholder.
  sessionId: '{{ stripe_session.id }}'
}).then(function (result) {
  // If `redirectToCheckout` fails due to a browser or network
  // error, display the localized error message to your customer
  // using `result.error.message`.
  if (result.error) {
          // If `redirectToCheckout` fails due to a browser or network
          // error, display the localized error message to your customer.
          var displayError = document.getElementById('error-message');
          displayError.textContent = result.error.message;
      }
});
}
</script>

{% endblock %}
{% block content %}
<div class="container">
  <div class="row pt-4">
    <div class="col-lg-6">
      <h3> Confirm plan and go to our payment provider </h3>
    </div>
  </div> <!-- row -->
<div class="row justify-content-center pt-2">
{% include "includeable/message_displayer.html" %}
  </div><!-- row -->
  <div class="row justify-content-center pt-2">
    <p>You have chosen to PAY. Go to payments-provider:  <button onclick="myFunction()">Go to stripe</button> </p>
    <br />
    <p id="error-message"></p>
    <p>Use this: 4242424242424242</p>
  </div><!-- row -->
</div><!-- container -->

{% endblock %}
