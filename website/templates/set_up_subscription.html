{% extends "base_generic.html" %}
{% load static %}
{% block extrascripts %}
<script src="https://js.stripe.com/v3/"></script>
<script>
var stripe = Stripe('{{ stripe_pk }}');

function myFunction(){
  document.getElementById("error-message").innerHTML = "myFunction is called";
  stripe.redirectToCheckout({
  sessionId: '{{ stripe_session.id }}'
}).then(function (result) {
  // If `redirectToCheckout` fails due to a browser or network
  // error, display the localized error message to your customer
  // using `result.error.message`.
  if (result.error) {
          // If `redirectToCheckout` fails due to a browser or network
          // error, display the localized error message to your customer.
          var displayError = document.getElementById('error-message');
          displayError.textContent = result.error.message;
      }
});
}
</script>

{% endblock %}
{% block content %}
<div class="container">
  <div class="row pt-4">
    <div class="col-sm-12">
      <h3> Confirm plan and go to our payment provider </h3>
    </div><!-- col -->
    <div class="col-sm-12">
      <p></p>
    </div><!-- col -->
  </div><!-- row -->
    <div class="row justify-content-center">
  {% include "includeable/message_displayer.html" %}
  {% include "includeable/plan_displayer.html" %}

    <div class="col-sm-12 text-center">
      <button class="btn btn-success" onclick="myFunction()">Set up payments</button>
      <a href="{% url 'choose-plan'%}" class="btn btn-warning">Chose a different plan</a>
    </div> <!-- col -->
    <div id="error-message" class="col-sm-12 text-center">&nbsp;</div>
  </div><!-- row -->
</div><!-- container -->

{% endblock %}
