{% extends "base_generic.html" %}

{% block extrascripts %}
<script src="https://js.stripe.com/v3/"></script>
<script>
var stripe = Stripe('{{ stripe_pk }}');

function stripeRedirect(){
  stripe.redirectToCheckout({
  sessionId: '{{ stripe_session.id }}'
}).then(function (result) {
  // If `redirectToCheckout` fails due to a browser or network
  // error, display the localized error message to your customer
  // using `result.error.message`.
  if (result.error) {
          // If `redirectToCheckout` fails due to a browser or network
          // error, display the localized error message to your customer.
          var displayError = document.getElementById('error-message');
          displayError.textContent = result.error.message;
      }
});
}
</script>
{% endblock %}


{% block content %}
<div class="container">
  <div class="row pt-4">
    <div class="col-12">
      <h3> Add payment method</h3>
    </div>
  </div> <!-- row -->
  <div class="row justify-content-center pt-2">
  {% include "includeable/message_displayer.html" %}
  </div><!-- row -->
  <div class="row">
    <div class="col-sm-12 text-center">
      This button will take you to our payemts provider:<br />
      <button class="btn btn-info" onclick="stripeRedirect()">Set up payment method</button>
    </div> <!-- col -->
    <div id="error-message" class="col-sm-12 text-center"></div>
    <div class="w-100"></div>
  </div> <!-- row -->
</div><!-- container -->

{% endblock %}
